CREATE DATABASE news_db
CHARACTER SET utf8mb4
COLLATE utf8mb4_hungarian_ci;

USE news_db;


Uj:

-- Writers table
CREATE TABLE writers (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    position VARCHAR(100) NOT NULL,
    dob DATETIME NOT NULL,
    password VARCHAR(255) NOT NULL
);

-- Category table
CREATE TABLE category (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL
);

-- Articles table
CREATE TABLE articles (
    id INT AUTO_INCREMENT PRIMARY KEY,
    date DATETIME NOT NULL,
    title VARCHAR(255) NOT NULL,
    text TEXT NOT NULL,
    writer_id INT NOT NULL,
    category_id INT NOT NULL,
    CONSTRAINT fk_articles_writer
        FOREIGN KEY (writer_id)
        REFERENCES writers(id)
        ON DELETE RESTRICT
        ON UPDATE CASCADE,
    CONSTRAINT fk_articles_category
        FOREIGN KEY (category_id)
        REFERENCES category(id)
        ON DELETE RESTRICT
        ON UPDATE CASCADE
);

Adatok:

INSERT INTO writers (id, name, position, dob, password) VALUES
(1, 'Hanna', "CFO", '2006-01-14 00:00:00', 'encrypted_pw_1'),
(2, 'Lara', "COO", '2005-11-19 00:00:00', 'encrypted_pw_2'),
(3, 'Levente', "CEO", '2005-11-19 00:00:00', 'encrypted_pw_3');


INSERT INTO category (id, name) VALUES
(1, 'World'),
(2, 'Szechenyi'),
(3, 'Business'),
(4, 'Opinion'),
(5, 'Entertainment');

Regi:


CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nev VARCHAR(100) NOT NULL,
    email VARCHAR(150) NOT NULL UNIQUE,
    jelszo VARCHAR(255) NOT NULL
);

CREATE TABLE business_people (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nev VARCHAR(100) NOT NULL,
    dob DATE,
    position VARCHAR(100)
);

CREATE TABLE category (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nev VARCHAR(100) NOT NULL
);

CREATE TABLE articles (
    id INT AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    body TEXT NOT NULL,
    date DATE NOT NULL,
    category_id INT,
    FOREIGN KEY (category_id) REFERENCES category(id)
        ON DELETE SET NULL
        ON UPDATE CASCADE
);

CREATE TABLE views (
    user_id INT NOT NULL,
    article_id INT NOT NULL,
    view_date DATETIME DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (user_id, article_id),
    FOREIGN KEY (user_id) REFERENCES users(id)
        ON DELETE CASCADE,
    FOREIGN KEY (article_id) REFERENCES articles(id)
        ON DELETE CASCADE
);

CREATE TABLE write_article (
    business_people_id INT NOT NULL,
    article_id INT NOT NULL,
    PRIMARY KEY (business_people_id, article_id),
    FOREIGN KEY (business_people_id) REFERENCES business_people(id)
        ON DELETE CASCADE,
    FOREIGN KEY (article_id) REFERENCES articles(id)
        ON DELETE CASCADE
);
